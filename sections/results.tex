\chapter{Результаты}

\section{Генерация синтетических данных с помощью прямой модели}

В процессе разработки алгоритма картирования необходим некоторый массив данных, который позволит эффективно исследовать свойства алгоритма и сравнивать его с другими методами в одних и тех же сценариях. Однако  сбор таких данных с реального робота представляет большие трудности:

\begin{itemize}

  \item Необходимо знать положение робота в пространстве в каждый момент времени, и следовательно определие положения робота каждый раз при измерении, требует либо специального полигона, либо наличие инструментов, которые позволят быстро и точно это сделать. Ясно, что это не всегда возможно.

  \item Свойства сонара сильно отличаются в зависимости от окружения, поэтому для полноты исследования того или иного метода картирования требуется возможность проводить эксперименты в различных условиях. На реальном роботе это далеко не всегда возможно.

\end{itemize}

В этой работе предлагается простой метод, который позволяет быстро получать эксперементальные синтетические данные. Ядром этого метода является прямая модель сонара \eqref{sonar_forward_model:5}. 

На вход алгоритму подаётся некоторая карта проходимости, например в формате картинки, с заданным масштабом. Затем можно задать траекторию движения робота и параметры прямой модели сонара, которые позволяют простым образом моделировать различные сценарии работы сонара. Каждая клетка на входной картинке является препятствием определенного размера. Задавая положение робота на этой карте, мы имитируем измерение сонара следующим образом:

\begin{enumerate}
  \item С вероятностью $p_{rand}$ сонар выдает случайное значение дальности, распределенное равномерно на $[R_{min}, R_{max}]$.

  \item Находим в области видимости ближайшее не рассмотренное препятствие. С вероятностью $p_{hit}$ препятствие считается замеченным сонаром, дистанция от сонара до этой клетки с нормальным шумом выдается в качестве измерения.

  \item С вероятностью $1 -p_{hit}$ препятствие считается незамеченным сонаром, оно помечается как рассмотренное и алгоритм возвращается к предыдущему шагу.

  \item Если все препятствия остались незамеченными, то выдается максимальное измерение $R_{max}$. 
\end{enumerate}

Таким образом, наш метод решает указанные выше проблемы и позволяет быстро создать необходимый массив наблюдений сонаров.

\section{Детали реализации}

\subsection{Область видимости сонара}

При реализации области видимости сонара использовалось предположение о том, что она явлется выпуклой областью. В качестве приближения реальной области видимости используется выпуклый многоугольник, заданный множеством координат своих вершин $V = \{(x_v,y_v)\}$, упорядоченных таким образом, что контур, который они образуют, является правильно ориентированной кривой. Тогда алгоритм определения того, лежит ли точка $(x, y)$ внутри луча сенсора выглядит следующим образом

\begin{enumerate}
  \item пусть нужно проверить лежит ли точка $P$ внутри области видимости сонара
  \item для каждой вершины из $V$, кроме первой из этого множества, обозначив за $a = V_i - V_0$ и $b = P - V_i$, по порядку проверяем выполнение следующего условия
    $$a_x b_y - b_x y_a \ge 0$$
  Если условие выше выполняется, продолжаем проверку. Не выполнение этого условия означает, что точка $P$ не принадлежит области видимости датчика.

  \item На последнем шаге проверяем это же условие, считая что  $a = V_0 - V_{last}$ и $b = P - V_{last}$
\end{enumerate}


\subsection{Диаграмма чувствительности сонара}

Диаграмма чувствительности, которая используется в алгоритме, описанном в Главе \ref{chapter:gradient_mapping}, была получена из TODO\_specification. Вследствии дискретности карты проходимости, можно дискретизировать функцию $s(x,y)$. На рисунке image\_specification видно, что представляет из себя $d(x,y)$. 

Рассмотрим пару $(\Omega, s)$, где $\Omega$ -  некоторой области, а $s$ - минимальная площадь препятствия, которое обнаруживается сонаром в этой области. Таким образом, $s(x,y)$ можно представить как множество пар $\tilde{s} = \{(\Omega_i, s_i)\}$. Будем считать, что  $\Omega_i$ может быть представлена таким же образом, как и область видимости. В зависимости от масштаба карты, можно строить различные приближения $\tilde{s}$ для диаграммы чувствительности. На рисунке image\_sensetive\_diagram можно увидеть  $\tilde{s}$, которое используется в работе.


\section{Численные эксперименты и результаты}

В этой части главы описаны проведенные численные эксперименты и результаты разработанных в данной работе алгоритмов. Результаты сравниваются с результатами картирования методом с обратной моделью сенсора.  

\subsection{Алгоритм картирования методом градиентного спуска}
